<?xml version="1.0"?>

<scenario xmlns="http://www.github/cliffe/SecGen/scenario"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="http://www.github/cliffe/SecGen/scenario">

	<name>NDG Forensics Scenario</name>
	<author>Jason Zeller</author>
	<author>Michael Stainbrook</author>
	<author>Chris Jacobs</author>

	<description>
		A scenario to compliment the NDG Forensics labs. For more information about the labs please see:
		https://www.netdevgroup.com/content/cybersecurity/labs/ndg_forensics.html
	</description>

	<type>ctf</type>
	<difficulty>easy</difficulty>

	<system>
		<system_name>ndgforensics</system_name>
		<base platform="linux" type="server"/>

		<service name="Random Parameterised Website">

			<input into="images_to_leak" unique_module_list="unique_encoders">
				<generator type="hidden_data_in_image_file">
					<input into="base64_image">
						<generator type="scenario_image_generator"/>
					</input>
					<input into="strings_to_leak">
						<generator type="flag_generator"/>
						<value>YOU HAVE FOUND OUR SECRET MESSAGE!</value>
						<value>The Pwnable Pwnies have one main objective. It is our only goal. </value>
						<value>We have the technology. We have the capability. </value>
						<value>Internet images need a change. We will be that change. </value>
						<value>To change all Internet images worldwide to ponies. Flag here: </value>
					</input>
				</generator>
			</input>

			<input into="images_mode">
				<value>777</value>
			</input>

			<input into="organisation">
				<generator type="random_organisation">
					<input into="business_name">
						<value>Pwnable Pwnies</value>
					</input>
					<input into="business_motto">
						<value>Changing the world, one image at a time</value>
					</input>
					<input into="domain">
						<value>pwnablepwnies.org</value>
					</input>
					<input into="industry">
						<value>Hacker's Extraordinaire</value>
					</input>
					<input into="intro_paragraph">
						<value/>
					</input>
				</generator>
			</input>

			<input into="main_page_paragraph_content">
				<generator type="html_snippet_generator">
          <input into="heading">
            <value>We need your help!</value>
          </input>
          <input into="paragraphs" unique_module_list="unique_encoders">
            <value>You have received a strange message. Can you decode it to read the contents?</value>
            <!--<encoder type="string_encoder">-->
            <encoder type="caesar_cipher">
              <input into="strings_to_encode">
                <value>Log into the server and check your mail.</value>
                <value>Here's a flag for your efforts.</value>
                <generator type="flag_generator"/>
                <generator type="concat_paragraph">
                  <input into="data">
                    <value>Username:</value>
                  </input>
                </generator>
                <generator type="concat_paragraph">
                  <input into="data">
                    <value>Password:</value>
                  </input>
                </generator>
              </input>
            </encoder>
          </input>
        </generator>
			</input>
		</service>

		<network module_path=".*private_network_1"/>
		<!-- Cleanup system, and set root password of system -->
		<build type="cleanup">
      <input into="root_password">
        <!-- <generator type=".*strong_password.*"/> -->
				<value>Train1ng$</value>
      </input>
    </build>

	</system>

</scenario>